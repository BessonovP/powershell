#Import-Csv "C:\Script\29\email.csv " -Encoding UTF8 | foreach {Set-ADUser -Identity $_.displayName -EmailAddress $_.EmailAddress}
Import-Module ActiveDirectory

Import-Csv "C:\Script\29\email.csv" -Encoding UTF8 | ForEach-Object {
    $displayName = $_.displayName
    $email = $_.EmailAddress

    # Поиск по DisplayName
    $user = Get-ADUser -Filter "DisplayName -eq '$displayName'" -Properties EmailAddress

    if ($user) {
        Set-ADUser -Identity $user.DistinguishedName -EmailAddress $email
        Write-Host "Обновлён: $displayName => $email" -ForegroundColor Green
    }
    else {
        Write-Host "Пользователь не найден: $displayName" -ForegroundColor Red
    }
}
